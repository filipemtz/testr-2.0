<div class="course-name">
    {{ course.name }}
</div>

<main>
    <div class="back-link"><a [routerLink]="['/']">Back</a></div>
    <button class="new-section btn" (click)="openAddSectionModal(course, addSectionModal)"><mat-icon>add</mat-icon> New Section</button>
    <div *ngIf="sections.length > 0; else noSections">
        <div *ngFor="let section of sections">
            <div *ngIf="section.course == course.url" >
                <div class="section-item">
                    {{ section.name }}
                    <button class="fa-solid fa-pencil btn text-primary" aria-hidden="true" (click)="openEditSectionModal(section, editSectionModal)"></button>
			        <button class="fa-solid fa-close btn text-danger" aria-hidden="true" (click)="openDeleteSectionModal(section, deleteSectionModal)"></button>
                </div>
                <div *ngFor="let question of questions">
                    <div *ngIf="question.section == section.url;">
                        <div class="questions">
                            <a [routerLink]="['/question', question.id]" class="question-link">{{ idx }}. {{ question.name }} </a>
                            <button [routerLink]="['/question/edit', question.id]" class="fa-solid fa-pencil btn text-primary" aria-hidden="true"></button>
                            <button class="fa-solid fa-close btn text-danger" aria-hidden="true" (click)="openDeleteQuestionModal(question, deleteQuestionModal)"></button>
                            {{ inc_idx() }}
                        </div>
                    </div>
                </div>
                {{ inc_cont() }}
            </div>
            {{ reset_idx() }}
        </div>
        <div *ngIf="cont > 0; else noSections">

        </div>
        {{ reset_cont() }}
    </div>
</main>

<ng-template #noSections>
    <p class="no-sections-message">No sections are available.</p>
</ng-template>

<ng-template #addSectionModal let-modal>
	<div class="modal-header">
	  <h4 class="modal-title" id="modal-basic-title">Criar nova seção</h4>
	  <button type="button" class="btn-close" aria-label="Fechar" (click)="modal.dismiss('Cross click')"></button>
	</div>
	<div class="modal-body">
		<form [formGroup]="addForm">
		  <div class="mb-3">
			<label for="name">Name</label>
			<input id="name" type="text" class="form-control" formControlName="name">
			<div *ngIf="editForm.get('name')?.invalid && (editForm.get('name')?.dirty || editForm.get('name')?.touched)" class="text-danger">
			  Nome do curso é obrigatório.
			</div>
		  </div>
		</form>
	  </div>
	<div class="modal-footer">
	  <button type="button" class="btn btn-outline-dark" (click)="modal.dismiss()">Cancelar</button>
	  <button type="button" class="btn btn-danger" (click)="confirmAddSection()">Criar</button>
	</div>
</ng-template>

<ng-template #deleteSectionModal let-modal>
	<div class="modal-header">
	  <h4 class="modal-title" id="modal-basic-title">Deletar seção</h4>
	  <button type="button" class="btn-close" aria-label="Fechar" (click)="modal.dismiss('Cross click')"></button>
	</div>
	<div class="modal-body">
	  Tem certeza que deseja deletar a seção?
	</div>
	<div class="modal-footer">
	  <button type="button" class="btn btn-outline-dark" (click)="modal.dismiss()">Cancelar</button>
	  <button type="button" class="btn btn-danger" (click)="confirmDeleteSection()">Deletar</button>
	</div>
  </ng-template>

  <ng-template #deleteQuestionModal let-modal>
	<div class="modal-header">
	  <h4 class="modal-title" id="modal-basic-title">Deletar seção</h4>
	  <button type="button" class="btn-close" aria-label="Fechar" (click)="modal.dismiss('Cross click')"></button>
	</div>
	<div class="modal-body">
	  Tem certeza que deseja deletar a questão?
	</div>
	<div class="modal-footer">
	  <button type="button" class="btn btn-outline-dark" (click)="modal.dismiss()">Cancelar</button>
	  <button type="button" class="btn btn-danger" (click)="confirmDelete()">Deletar</button>
	</div>
  </ng-template>

  <ng-template #editSectionModal let-modal>
	<div class="modal-header">
	  <h4 class="modal-title" id="modal-basic-title">Editar seção</h4>
	  <button type="button" class="btn-close" aria-label="Fechar" (click)="modal.dismiss('Cross click')"></button>
	</div>
	<div class="modal-body">
	  <form [formGroup]="editForm">
		<div class="mb-3">
		  <label for="name">Name</label>
		  <input id="name" type="text" class="form-control" formControlName="name">
		  <div *ngIf="editForm.get('name')?.invalid && (editForm.get('name')?.dirty || editForm.get('name')?.touched)" class="text-danger">
			Nome da seção é obrigatório.
		  </div>
		</div>
	  </form>
	</div>
	<div class="modal-footer">
	  <button type="button" class="btn btn-outline-dark" (click)="modal.dismiss()">Cancelar</button>
	  <button type="button" class="btn btn-primary" (click)="confirmSaveSection()">Salvar</button>
	</div>
</ng-template>