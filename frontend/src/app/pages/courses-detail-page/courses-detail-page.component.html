<h1 class="display-2 text-center mb-4">
	{{ course.name }}
</h1>
<a class="icon-link icon-link-hover mb-2" [routerLink]="['/']">
	<i class="bi fa-solid fa-arrow-left"></i>
	Back
</a>
<br>

<button class="btn btn-outline-primary" (click)="openAddSectionModal(addSectionModal)">
	<i class="fa-regular fa-plus"></i>
	Nova Seção
</button>

<div *ngIf="sections.length > 0; else noSections">
	<div *ngFor="let section of sections;">
		<div *ngIf="section.isEditing; else viewSection" class="d-flex flex-wrap justify-content-start">
			<input class="form-control form-control-lg fw-semibold w-50"  [(ngModel)]="section.name" />
			<div class="d-flex align-items-center">
				<button type="button" class="btn btn-rounded fa-check fa-solid text-success ms-1" (click)="confirmEditSection(section)"></button>
				<button type="button" class="btn btn-rounded fa-solid fa-xmark text-danger ms-1" (click)="section.isEditing=false"></button>
			</div>
		</div>
		<ng-template #viewSection>
			<div class="d-flex justify-content-start align-items-center">
				<h4 class="p-2">{{ section.name }}</h4>
				<button type="button" class="btn fa-solid btn-rounded fa-pencil text-primary ms-1" (click)="section.isEditing=true"></button>
				<button type="button" class="btn fa-solid btn-rounded fa-trash text-danger ms-1" (click)="openDeleteSectionModal(section, deleteSectionModal)"></button>
			</div>
				<div *ngIf="section.questions?.length ?? -1 > 0; else noQuestions">
					<div *ngFor="let question of section.questions">
						{{ question.name }}
					</div>
				</div>
		</ng-template>
	</div>
</div>

<ng-template #noSections>
	<p class="">Não existem seções disponíveis.</p>
</ng-template>

<ng-template #noQuestions>
	<p class="">Não existem questões disponíveis.</p>
</ng-template>

<ng-template #addSectionModal let-modal>
	<div class="modal-header">
		<h4 class="modal-title" id="modal-basic-title">Criar nova seção</h4>
		<button type="button" class="btn-close" aria-label="Fechar" (click)="modal.dismiss('Cross click')"></button>
	</div>
	<div class="modal-body">
		<form [formGroup]="addSectionForm">
			<div class="mb-3">
				<label for="name">Name</label>
				<input id="name" type="text" class="form-control" formControlName="name">
				<div *ngIf="editForm.get('name')?.invalid && (editForm.get('name')?.dirty || editForm.get('name')?.touched)"
					class="text-danger">
					Nome do curso é obrigatório.
				</div>
			</div>
		</form>
	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-outline-secondary" (click)="modal.dismiss()">Cancelar</button>
		<button type="button" class="btn btn-primary" (click)="confirmAddSection()">Criar</button>
	</div>
</ng-template>

<!-- <ng-template #addQuestionModal let-modal>
	<div class="modal-header">
		<h4 class="modal-title" id="modal-basic-title">Criar nova questão</h4>
		<button type="button" class="btn-close" aria-label="Fechar" (click)="modal.dismiss('Cross click')"></button>
	</div>
	<div class="modal-body">
		<form [formGroup]="addQuestionForm">
			<div>
				<label for="name" class="base-form">Name:</label>
				<input id="name" type="text" class="form-control base-bar" formControlName="name">
				<div *ngIf="editForm.get('name')?.invalid && (editForm.get('name')?.dirty || editForm.get('name')?.touched)"
					class="text-danger">
					Nome da questão é obrigatório.
				</div>
			</div>

			<div>
				<label for="description" class="base-form">Description:</label>
				<input id="description" type="text" class="form-control base-bar" formControlName="description">
			</div>

			<div>
				<label for="language" class="base-form">Language:</label>
				<select class="form-control" id="language" formControlName="language">
					<option value="" disabled>Select language</option>
					<option value="PT">Python</option>
					<option value="CC">C/C++</option>
				</select>
			</div>

			<div>
				<label for="time_limit_seconds" class="base-form">Time limit seconds:</label>
				<input id="time_limit_seconds" type="number" class="form-control base-bar" formControlName="time_limit_seconds">
				<div
					*ngIf="editForm.get('time_limit_seconds')?.invalid && (editForm.get('time_limit_seconds')?.dirty || editForm.get('time_limit_seconds')?.touched)"
					class="text-danger">
					Tempo limite de execução em segundos obrigatório.
				</div>
			</div>

			<div>
				<label for="memory_limit" class="base-form">Memory limit:</label>
				<input id="memory_limit" type="number" class="form-control base-bar" formControlName="memory_limit">
				<div
					*ngIf="editForm.get('memory_limit')?.invalid && (editForm.get('memory_limit')?.dirty || editForm.get('memory_limit')?.touched)"
					class="text-danger">
					Limite de memória obrigatório.
				</div>
			</div>

			<div>
				<label for="cpu_limit" class="base-form">CPU limit:</label>
				<input id="cpu_limit" type="number" class="form-control base-bar" formControlName="cpu_limit">
				<div
					*ngIf="editForm.get('cpu_limit')?.invalid && (editForm.get('cpu_limit')?.dirty || editForm.get('cpu_limit')?.touched)"
					class="text-danger">
					Limite da CPU obrigatório.
				</div>
			</div>

			<div>
				<label for="submission_deadline" class="base-form">Submission deadline:</label>
				<input id="submission_deadline" type="text" class="form-control base-bar" formControlName="submission_deadline">
				<div
					*ngIf="editForm.get('submission_deadline')?.invalid && (editForm.get('submission_deadline')?.dirty || editForm.get('submission_deadline')?.touched)"
					class="text-danger">
					Data limite obrigatória.
				</div>
			</div>
		</form>
	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-outline-secondary" (click)="modal.dismiss()">Cancelar</button>
		<button type="button" class="btn btn-danger" (click)="confirmAddQuestion()">Criar</button>
	</div>
</ng-template> -->

<ng-template #deleteSectionModal let-modal>
	<div class="modal-header">
		<h4 class="modal-title" id="modal-basic-title">Deletar seção</h4>
		<button type="button" class="btn-close" aria-label="Fechar" (click)="modal.dismiss('Cross click')"></button>
	</div>
	<div class="modal-body">
		Tem certeza que deseja deletar a seção {{ sectionToDelete?.name}}?
	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-outline-secondary" (click)="modal.dismiss()">Cancelar</button>
		<button type="button" class="btn btn-danger" (click)="confirmDeleteSection()">Deletar</button>
	</div>
</ng-template>

<!-- <ng-template #deleteQuestionModal let-modal>
	<div class="modal-header">
		<h4 class="modal-title" id="modal-basic-title">Deletar seção</h4>
		<button type="button" class="btn-close" aria-label="Fechar" (click)="modal.dismiss('Cross click')"></button>
	</div>
	<div class="modal-body">
		Tem certeza que deseja deletar a questão?
	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-outline-secondary" (click)="modal.dismiss()">Cancelar</button>
		<button type="button" class="btn btn-danger" (click)="confirmDelete()">Deletar</button>
	</div>
</ng-template> -->
